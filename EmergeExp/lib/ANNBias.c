#include <..\lib\ANNBias.h>

const float weightIH[ANN_INPUT_SIZE+1][ANN_HIDDEN_SIZE] = {{-8.17410411e+00,-3.69749173e-01,-3.37432496e+00,-9.63443796e-01, -2.05480242e+00,-2.47940699e+00,-2.65349088e+00, 7.30936439e-01,1.14655498e+01,-2.11181218e+00,-2.77133659e+00,-2.23608357e-01}, { -3.38155701e+00,-1.77392657e+00, 3.52788305e+00,-1.83199349e+00,1.13528297e+00,-3.04734088e+00,-3.09437011e+00,-2.24593708e+00, -6.09067878e+00,-5.87841529e-01,-9.22921968e+00, 5.41888379e+00}, { -5.45565058e-01,-9.80997784e-01,-7.33665619e+00,-6.30379422e-01, -4.54100409e+00,-2.44817287e+00, 1.94685605e+00,-6.63300392e-01, -3.49982277e+00, 2.26097764e-01,-5.10432119e+00, 7.56930451e+00}, { -1.32819803e+00,-1.60359560e+00,-1.18752630e+00,-8.44146668e-01, -6.10353674e+00, 8.88425072e-02, 1.34687188e+00, 8.46895328e-02,6.20978542e-01,-1.24527067e+00, 3.74170017e-02,-6.93612506e-03}, {1.30456673e-02, 2.07891088e-02, 1.88574272e+00,-1.95968591e+00, -1.86779724e-01, 1.76298688e+00, 6.22535863e-01,-4.78206449e+00, -4.40811040e+00,-1.86025238e+00, 1.40258315e+00,-5.78047356e-01}, { -1.13343876e+01,-1.07238601e+00,-2.26320855e+00,-2.85557433e+00, -4.30360936e-01,-4.46404752e+00,-3.01445816e+00, 2.31736797e+00, -4.85847416e+00, 1.63945783e+00, 6.52674553e-01, 1.60174281e+00}, {7.08145864e+00,-7.16001758e+00,-2.96141642e+00,-4.40296705e+00, -1.43052086e+00, 6.60299746e-01,-9.84715810e+00,-1.96978773e-01, -5.61739930e+00, 1.05298908e+00,-7.08031640e+00,-1.82598223e+00}, { -5.21541228e-01, 1.40605048e+00, 1.67800166e+01, 7.75245925e+00, -8.40357038e+00,-5.69548040e+00,-7.14677493e+00,-1.03188813e+01, -6.72435068e-01,-3.05191053e+00,-6.09368678e+00,-5.20491542e+00}, { -2.59042307e+00, 1.63377662e-01, 4.48259728e+00,-4.83490091e-01,2.32345203e+00, 8.94164201e+00,-1.21021047e+00,-1.54613708e+00, -5.84568438e+00, 1.42589562e+00,-1.49925767e+00,-7.59362235e+00}, { -9.08220926e-01, 7.85167115e-01, 2.27989880e-01, 3.59456952e+00,3.02346454e+00, 4.87707627e+00, 4.57642331e+00,-3.68051235e+00, -3.10412572e+00,-1.16776719e+00, 2.00257429e+00,-5.68176380e+00}, {1.02065545e+00,-4.08772417e+00,-1.28792113e+00,-2.41857335e+00, -8.06910809e+00,-4.81817218e+00,-4.32885542e+00, 5.80026591e+00, -2.95272641e+00,-2.51720754e+00,-1.18860104e+01,-1.84909306e+00}, { -1.77849212e+00,-5.28184039e-01,-6.72947883e+00,-2.36353262e+00, -3.35569876e+00, 9.04116452e+00,-4.38711618e+00, 5.22523113e+00,5.56516061e+00,-5.57599057e-01,-3.78495460e+00,-1.71359136e+00}, { -3.18463569e+00, 3.01905188e+00,-1.77478618e+00, 1.81683581e+00,1.48477960e+00,-2.15760254e+00, 4.50226556e+00,-3.94071610e+00, -6.51057134e+00,-5.88978152e+00,-9.09160065e-01,-4.14544629e-01}};
const float weightHO[ANN_HIDDEN_SIZE+1][ANN_OUTPUT_SIZE] = {{2.16997555e+00, 4.31267150e-02, 4.22607818e-02, 5.22098499e-03, -1.00681048e+01, 1.44809186e-01}, {5.30910448e-02,-1.93676127e-03,-2.72708398e-01, 4.40621325e-02, -1.70652830e-03, 6.59630109e-01}, {8.45661733e-03,-1.16720581e-09, 3.40109511e-09, 7.48721888e-10,2.19653352e-09, 3.82533239e-09}, {1.19932253e-08, 1.31581993e-10,-1.11042252e-09, 8.34966045e-09,4.02198661e-10,-8.83070823e-10}, { -1.16268837e-08,-7.30633578e-12, 6.19039211e-01,-8.04287441e-09, -2.68058732e-09,-4.32488411e-09}, { -9.48400064e-09,-2.98221742e-08, 4.82924424e-10, 2.70796131e-09, -1.14053756e-08,-1.79500824e-09}, {3.05901409e-09, 1.98591337e-08,-6.77817482e-10,-6.19039201e-01, -2.00540202e-08,-6.73430994e-09}, { -1.07319201e-08,-2.36767022e-08,-7.44312241e-08, 1.23821543e-09,6.75671559e-09,-2.80460636e-08}, { -4.51824414e-09, 7.68149665e-09, 4.92099695e-08,-1.72080455e-09,3.10734231e-01,-4.43277144e+00}, {6.49196207e-01,-5.84621252e+00,-1.59863047e+00,-5.38427571e+00,1.69646853e+00, 2.19299360e+00}, { -3.25876625e+00,-5.01985644e-01,-8.04574551e-01, 6.01976427e+00, -7.49499247e-01,-5.07032977e-01}, { -4.62124789e+00, 3.18765888e+00,-3.27662005e+00, 7.78128226e-01, -2.77174317e+00,-1.97732499e+00}, {2.62565831e+00,-7.10993149e+00, 1.33053582e+00,-3.70620608e+00,2.44130199e-01, 1.98476591e+00}};

void propagateANN(float input [],float output[]){
    float sumH[ANN_HIDDEN_SIZE];
    float hidden[ANN_HIDDEN_SIZE];
    float sumO[ANN_OUTPUT_SIZE];
    int i,j,k;
    for( j = 0 ; j < ANN_HIDDEN_SIZE ; j++ ) {         /* j loop computes hidden unit activations */
        
        sumH[j] = weightIH[0][j];
        for( i = 1 ; i < ANN_INPUT_SIZE + 1 ; i++ ) {
            sumH[j] += input[i-1] * weightIH[i][j] ;
        }
        hidden[j] = 1.0/(1.0 + exp(-sumH[j])) ;
    }
    
    for( k = 0 ; k < ANN_OUTPUT_SIZE ; k++ ) {         /* k loop computes output unit activations */

        sumO[k] = weightHO[0][k];
        for( j = 1 ; j < ANN_HIDDEN_SIZE + 1  ; j++ ) {
            sumO[k] += hidden[j-1] * weightHO[j][k] ;
        }
        output[k] = 1.0/(1.0 + exp(-sumO[k])) ;

    } 
      
}